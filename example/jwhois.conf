# This is jwhois.conf - an example configuration file for jwhois
#
#

#
# Local domain registries and pointers to cidr-blocks and handles.
# This is where jwhois begins the search for a Whois server to query
#
whois-servers {
	#
	# The type can be either cidr or regex, the former matches using CIDR
	# blocks and the later using regular expressions.
	#
	type = regex;

	#
	# You can use the special value `struct' to redirect the query
	# to another block which optionally can use another type of matching.
	# Here we use it to have IPv4 numbers matched using CIDR blocks instead
	# of regular expressions.  See below for the definition of cidr-blocks.
	#
	"\\([0-9]+\\.\\)+[0-9]+" = "struct cidr-blocks";
	"^CORE-[0-9]+$" = "struct handles";
	"^CO[CH]O-[0-9]+$" = "struct handles";
	"^NETBLK-.+" = "struct handles";
	".*-[A-Z]+$" = "struct handles";

	#
	# Catch AS numbers
	#
	"^[0-9]+$" = "whois.arin.net";
	"^ASN-" = "whois.arin.net";
	"^AS[0-9]+$" = "whois.radb.net";

	#
	# Redirect IPv6 numbers to the correct host
	#
	".*:.*" = "whois.6bone.net";

	#
	# If your host and network supports it, you can also specify IPv6
	# addresses in the server field.
	#
	# ".*:.*" = "::1"
	#

	#
	# This is a special construct designed with the whois-servers.net service
	# in mind. If you use this, jwhois will query whois-servers.net for which
	# whois server to use for each domain query.
	#
	# ".*" = "whois-servers";

	".*\\.uk\\.com$" = "whois.uk.com";
	".*\\.eu\\.org$" = "whois.eu.org";

	".*\\.ac$" = "whois.nic.ac";
	".*\\.al$" = "whois.ripe.net";
	".*\\.am$" = "whois.amnic.net";
	".*\\.as$" = "whois.nic.as";
	".*\\.at$" = "whois.nic.at";
	".*\\.net\\.au$" = "whois.connect.com.au";
	".*\\.au$" = "whois.aunic.net";
	".*\\.az$" = "whois.ripe.net";
	".*\\.ba$" = "whois.ripe.net";
	".*\\.be$" = "whois.dns.be";
	".*\\.bg$" = "whois.ripe.net";
	".*\\.bm$" = "rwhois.ibl.bm 4321";
	".*\\.br$" = "whois.nic.br";
	".*\\.bv$" = "whois.ripe.net";
	".*\\.by$" = "whois.ripe.net";
	".*\\.ca$" = "whois.cira.ca";
	".*\\.cc$" = "whois.nic.cc";
	".*\\.ch$" = "whois.nic.ch";
	".*\\.ck$" = "whois.nic.ck";
	".*\\.cl$" = "whois.nic.cl";
	".*\\.edu\\.cn$" = "whois.edu.cn";
	".*\\.cn$" = "whois.cnnic.net.cn";
	".*\\.cx$" = "whois.nic.cx";
	".*\\.cy$" = "whois.ripe.net";
	".*\\.cz$" = "whois.nic.cz";
	".*\\.de$" = "whois.denic.net";
	".*\\.dk$" = "whois.dk-hostmaster.dk";
	".*\\.do$" = "whois.nic.do";
	".*\\.dz$" = "whois.ripe.net";
	".*\\.ee$" = "whois.ripe.net";
	".*\\.eg$" = "whois.ripe.net";
	".*\\.es$" = "whois.ripe.net";
	".*\\.fi$" = "whois.ripe.net";
	".*\\.fj$" = "whois.usp.ac.fj";
	".*\\.fm$" = "www.dot.fm";
	".*\\.fo$" = "whois.ripe.net";
	".*\\.fr$" = "whois.nic.fr";
	".*\\.gov$" = "whois.nic.gov";
	".*\\.gg$" = "whois.isles.net";
	".*\\.gm$" = "whois.ripe.net";
	".*\\.gr$" = "whois.ripe.net";
	".*\\.gs$" = "whois.adamsnames.tc";
	".*\\.hk$" = "whois.hkdnr.net.hk";
	".*\\.hm$" = "whois.registry.hm";
	".*\\.hr$" = "whois.ripe.net";
	".*\\.hu$" = "whois.nic.hu";
	".*\\.id$" = "whois.idnic.net.id";
	".*\\.ie$" = "whois.domainregistry.ie";
	".*\\.il$" = "whois.isoc.org.il";
	".*\\.in$" = "whois.ncst.ernet.in";
	".*\\.int$" = "whois.isi.edu";
	".*\\.is$" = "whois.isnet.is";
	".*\\.it$" = "whois.nic.it";
	".*\\.je$" = "whois.isles.net";
	".*\\.jp$" {
		whois-server = "whois.nic.ad.jp";
 		query-format = "$* /e";
	}
	".*\\.kg$" = "whois.domain.kg";
	".*\\.kr$" = "whois.krnic.net";
	".*\\.kz$" = "whois.domain.kz";
	".*\\.la$" = "whois.nic.la";
	".*\\.li$" = "whois.nic.li";
	".*\\.lk$" = "whois.nic.lk";
	".*\\.lt$" = "whois.ripe.net";
	".*\\.lu$" = "whois.dns.lu";
	".*\\.lv$" = "whois.ripe.net";
	".*\\.ma$" = "whois.ripe.net";
	".*\\.mil$" = "whois.nic.mil";
	".*\\.mk$" = "whois.ripe.net";
	".*\\.mm$" = "whois.nic.mm";
	".*\\.ms$" = "whois.adamsnames.tc";
	".*\\.mt$" = "whois.ripe.net";
	".*\\.mx$" = "whois.nic.mx";
	".*\\.my$" = "whois.mynic.net";
	".*\\.ng$" = "pgebrehiwot.iat.cnr.it";
	".*\\.nl$" = "whois.domain-registry.nl";
	".*\\.no$" = "whois.norid.no";
	".*\\.nu$" = "whois.nic.nu";
	".*\\.nz$" = "whois.domainz.net.nz";
	".*\\.pe$" = "whois.rcp.net.pe";
	".*\\.pk$" = "whois.pknic.net.pk";
	".*\\.pl$" = "whois.dns.pl";
	".*\\.pt$" = "whois.dns.pt";
	".*\\.pw$" = "whois.nic.pw";
	".*\\.ro$" = "whois.rotld.ro";
	".*\\.ru$" = "whois.ripn.net";
	".*\\.se$" = "www.nic-se.se"; # "whois.nic-se.se";
	".*\\.sg$" = "whois.nic.net.sg";
	".*\\.sh$" = "whois.nic.sh";
	".*\\.si$" = "whois.arnes.si";
	".*\\.sj$" = "whois.ripe.net";
	".*\\.sk$" = "whois.ripe.net";
	".*\\.sm$" = "whois.ripe.net";
	".*\\.st$" = "whois.nic.st";
	".*\\.su$" = "whois.ripn.net";
	".*\\.tc$" = "whois.adamsnames.tc";
	".*\\.tf$" = "whois.adamsnames.tc";
	".*\\.th$" = "whois.thnic.net";
	".*\\.tj$" = "whois.nic.tj";
	".*\\.tm$" = "whois.nic.tm";
	".*\\.tn$" = "whois.ripe.net";
	".*\\.to$" = "whois.tonic.to";
	".*\\.tr$" = "whois.metu.edu.tr";
	".*\\.tw$" = "whois.twnic.net";
	".*\\.ua$" = "whois.ripe.net";
	".*\\.ac\\.uk$" = "whois.ja.net";
	".*\\.gov\\.uk$" = "whois.ja.net";
	".*\\.uk$" = "whois.nic.uk";
	".*\\.us$" = "whois.isi.edu";
	".*\\.va$" = "whois.ripe.net";
	".*\\.ve$" = "rwhois.nic.ve 4321";
	".*\\.vg$" = "whois.adamsnames.tc";
	".*\\.ws$" = "whois.worldsite.ws";
	".*\\.yu$" = "whois.ripe.net";
	".*\\.gb.com$" = "whois.nomination.net";
	".*\\.gb.net$" = "whois.nomination.net";
	".*\\.org\\.za$" = "rwhois.org.za 4321";
	".*\\.co\\.za$" = "whois.co.za";
	".*\\.za$" = "whois.frd.ac.za";
	
	#
	# Specify different port numbers to connect to by postfixing the IP
	# number or host with a space and the designated port. Default is to
	# use the whois port from /etc/services.
	#
	# ".*" = "whois.internic.net 666";

#	".*" {
#		whois-server = "whois.internic.net";
		# Make sure we only match on domain names
#		query-format = "domain $*";
	#}
}

#
# cidr-blocks contains a list of all known CIDR blocks assigned to
# RIPE or APNIC. Default all queries to ARIN which has most other blocks.
#
# see http://www.iana.org/assignments/ipv4-address-space
#
cidr-blocks {
	type = cidr;

	"61.0.0.0/8" = "whois.apnic.net";
	"62.0.0.0/8" = "whois.ripe.net";
	"80.0.0.0/8" = "whois.ripe.net";
	"81.0.0.0/8" = "whois.ripe.net";
	"164.0.0.0/11" = "whois.ripe.net";
	"164.32.0.0/13" = "whois.ripe.net";
	"164.40.0.0/16" = "whois.ripe.net";
	"169.208.0.0/16" = "whois.apnic.net";
	"192.16.192.0/24" = "whois.ripe.net";
	"192.164.0.0/16" = "whois.ripe.net";
	"193.0.0.0/8" = "whois.ripe.net";
	"194.0.0.0/8" = "whois.ripe.net";
	"195.0.0.0/8" = "whois.ripe.net";
	"200.128.0.0/9" = "whois.nic.br";
	"202.0.0.0/8" = "whois.apnic.net";
	"203.0.0.0/8" = "whois.apnic.net";
	"210.0.0.0/8" = "whois.apnic.net";
	"211.0.0.0/8" = "whois.apnic.net";
	"212.0.0.0/8" = "whois.ripe.net";
	"213.0.0.0/8" = "whois.ripe.net";
	"217.0.0.0/8" = "whois.ripe.net";
	"218.0.0.0/8" = "whois.apnic.net";
	default = "whois.arin.net";
}

#
# Handles for the various registries.
#
handles {
	type = regex;

	"^NETBLK-.+" = "whois.arin.net";

	"^COCO-[0-9]+$" = "whois.corenic.net";
	"^CORE-[0-9]+$" = "whois.corenic.net";
	"^COHO-[0-9]+$" = "whois.corenic.net";

	".*-RIPE$" = "whois.ripe.net";
	".*-ARIN$" = "whois.arin.net";
	".*-AP$" = "whois.apnic.net";
	".*-ORG$" = "whois.internic.net";
	".*-DOM$" = "whois.internic.net";
	".*-NORID$" = "whois.norid.no";
	".*-GANDI$" = "whois.gandi.net";
	".*-AU" = "whois.aunic.net";
	".*-CKNIC" = "whois.nic.ck";
	".*-IDNIC$" = "whois.idnic.net.id";
	".*-KG" = "whois.domain.kg";
	".*-NICAT" = "whois.nic.at";
	".*-CZ" = "whois.nic.cz";
}

#
# The server-options block defines a number of options specific for
# each host. 
#
server-options {
	"rwhois\\.nic\\.ve" {
		rwhois = true;
		rwhois-display = "dump";
		rwhois-limit = 10;
	}
	".*\\.internic\\.net" {
		#
		# This will match output from whois.internic.net. The
		# parenteses must be escaped and should enclose the hostname
		# to which to redirect the search.
		#
		whois-redirect = ".*Whois Server: \\(.*\\)";
	}

	"whois\\.crsnic\\.net" {
		whois-redirect = ".*Whois Server: \\(.*\\)";
	}

	"whois\\.arin\\.net" {
		#
		# Content redirection for whois.arin.net - allows redirection
		# of European and Asia-Pacific addresses to the appropriate
		# servers.
		#	
		whois-redirect = ".*at \\([Ww][Hh][Oo][Ii][Ss]\\.[A-Za-z]*\\.[Nn][Ee][Tt]\\)";
	}

	"whois\\.ncst\\.ernet\\.in" {
		# query-format defines how to format a whois query.
		# The special variable $* will be replaced by
		# the query as specified by the user.
		query-format = "domain $*";
	}

	".*\\.connect\\.com\\.au" {
		#
		# Referals from the net.au whois server.
		#
		whois-redirect =  ".*referto: whois -h \\([^ ]*\\) -p \\([0-9]*\\)";
	}

	"whois\\.co\\.za" {
		http = "true";
		http-method = "GET";
		http-action = "/cgi-bin/whois.sh";
		html-element = "Domain";			# <input> element
	}

	"www\\.nic-se\\.se" {
		http = "true";
		http-method = "GET";
		http-action = "/cgi-bin/whois/www-to-whois";
		html-element = "domain";
	}
}

#
# The cache feature is used to provide a local cache with Whois information.
# By default, the location of the database is /usr/local/var/jwhois.db and the
# default expire time is 7 days, but you can change those below.
#
#cachefile = "/var/lib/jwhois.db";

#
# This is the time after which an entry expires from the cache in hours.
#
#cacheexpire = 168;

#
# If you're using the whois-servers support, you can specify this option
# to override the compiled in domain for that service.
#
#whois-servers-domain = "whois-servers.net";

#
# Path to the browser to use for HTTP servers.
#
browser-pathname = "/usr/bin/lynx";

#
# Command line argument to browser to get output on stdout.
#
browser-stdarg = "-dump";

#
# Command line argument to browser to perform a POST operation.
# Please note that Jwhois currently only supports the format which
# Lynx uses to process POST data. That is, one option per line is
# sent to stdin, ended with three dashes.
#
browser-postarg = "-post_data";
